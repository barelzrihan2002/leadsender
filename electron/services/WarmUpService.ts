import type { Database } from 'better-sqlite3';
import type { WhatsAppManager } from './WhatsAppManager';
import { v4 as uuidv4 } from 'uuid';
import { getRandomDelay } from '../../src/lib/utils';

const WARMUP_MESSAGES = [
  // ברכות ושלומות
  'היי, מה נשמע?',
  'מה קורה?',
  'שלום, איך אתה?',
  'מה המצב?',
  'הכל בסדר?',
  'איך עבר היום?',
  'מה עושים?',
  'איך היה השבוע?',
  'מה חדש?',
  'איך הולך?',
  'בוקר טוב!',
  'ערב טוב!',
  'שבת שלום!',
  'שבוע טוב!',
  'חג שמח!',
  
  // תגובות חיוביות
  'הכל מצוין, תודה!',
  'ממש טוב, מה אצלך?',
  'בסדר גמור, תודה ששאלת',
  'הכל במיטבו',
  'לא יכול להתלונן',
  'הכל זורם',
  'ממש בסדר',
  'טוב, תודה לאל',
  'הכל טוב בחסדי השם',
  'ממש יפה',
  
  // שאלות ועניין
  'איך הולך בעבודה?',
  'מה שלומך?',
  'מה המצב במשפחה?',
  'הכל בריא?',
  'איך הילדים?',
  'מה תכניות לסוף שבוע?',
  'יש חדשות?',
  'מה עושים היום?',
  'איפה אתה?',
  'מה התכניות?',
  
  // הודעות קצרות
  'סבבה',
  'אחלה',
  'מעולה',
  'יפה',
  'בטח',
  'כן',
  'נכון',
  'הבנתי',
  'אוקיי',
  'טוב',
  'נהדר',
  'מצוין',
  'מעניין',
  'ברור',
  'בדיוק',
  
  // תודות והערכה
  'תודה רבה!',
  'אני מעריך את זה',
  'זה ממש נחמד מצידך',
  'תודה על ההודעה',
  'נחמד לשמוע ממך',
  'תודה שחשבת עלי',
  'מאוד שמחתי לשמוע',
  'זה היה נחמד',
  
  // שיחת חולין
  'איזה יום היה לך?',
  'עשית משהו מעניין לאחרונה?',
  'יש משהו חדש?',
  'מה אתה עושה עכשיו?',
  'איך עברו החגים?',
  'איך היו החופשות?',
  'מה התכניות לקיץ?',
  'איך הלימודים?',
  'מה העבודה?',
  'איך הפרויקט?',
  
  // המשך שיחה
  'אז מה אתה אומר?',
  'מה דעתך?',
  'מה חושבים?',
  'נשמע טוב',
  'זה נשמע מעניין',
  'ספר לי עוד',
  'באמת?',
  'וואו, לא ידעתי',
  'זה מגניב',
  'כיף',
  
  // הסכמה ותגובות
  'אני מסכים',
  'נכון מאוד',
  'בדיוק מה שחשבתי',
  'גם אני חושב ככה',
  'אתה צודק',
  'זה נכון',
  'יפה אמרת',
  'מדויק',
  'בול',
  'ממש',
  
  // שאלות רגילות
  'אתה פנוי היום?',
  'מתי אתה זמין?',
  'אפשר להתקשר?',
  'אתה בבית?',
  'אתה בעבודה?',
  'יש לך זמן?',
  'אפשר לדבר?',
  'מה שעה טובה?',
  'מתי נוח לך?',
  'אתה עסוק?',
  
  // תכנון והזמנות
  'בא לך להיפגש?',
  'מה דעתך ביום ראשון?',
  'אפשר לתאם?',
  'בוא נדבר',
  'נתראה?',
  'יש לך תכניות?',
  'רוצה להצטרף?',
  'אני פנוי אם אתה רוצה',
  
  // הודעות יומיומיות
  'בוקר של שישי!',
  'סוף שבוע נעים',
  'שבוע מוצלח',
  'יום טוב',
  'לילה טוב',
  'נסיעה טובה',
  'בהצלחה',
  'שיהיה בשעה טובה',
  
  // תגובות לשמיעת חדשות
  'שמעת מה קרה?',
  'ראית את זה?',
  'יש לך מושג על מה זה?',
  'אתה יודע משהו על זה?',
  'שמעת על זה?',
  
  // עידוד ותמיכה
  'בהצלחה בכל מקרה!',
  'אני בטוח שיהיה בסדר',
  'זה יסתדר',
  'תצליח בוודאי',
  'אני איתך',
  'אם צריך משהו, אני פה',
  'תמיד אפשר לפנות',
  
  // הערות כלליות
  'זה מצחיק',
  'זה מעניין',
  'לא ידעתי את זה',
  'טוב לדעת',
  'כדאי לזכור',
  'חשוב להכיר',
  'שווה לבדוק',
  
  // שאלות על מצב רוח
  'איך אתה מרגיש?',
  'הכל טוב אצלך?',
  'אתה בסדר?',
  'הכל במקום?',
  'יש משהו?',
  'צריך משהו?',
  
  // תיאום והסכמות
  'בסדר גמור',
  'מעולה, ככה נעשה',
  'נשמע טוב לי',
  'אני מסכים',
  'בטח, למה לא',
  'זה עובד',
  'מתאים',
  'אין בעיה',
  'בטח, אני איתך',
  
  // המשכים לשיחה
  'אז בקיצור...',
  'אגב...',
  'לגבי מה ששאלת...',
  'חזרה לנושא...',
  'עוד דבר...',
  'רציתי לשאול...',
  'רק לעדכן...',
  'בינינו...',
  
  // סיומים
  'נדבר מאוחר יותר',
  'נשמע אחר כך',
  'נהיה בקשר',
  'תן לי לדעת',
  'עדכן אותי',
  'אני אחזור אליך',
  'נדבר בהמשך',
  'להתראות',
  
  // שאלות על זמן
  'מתי זה היה?',
  'כמה זמן זה לוקח?',
  'מתי אתה חושב?',
  'איזה זמן טוב?',
  'יש מועד?',
  
  // עוד ברכות
  'בוקר טוב חברי',
  'שיהיה לך יום נעים',
  'סוף שבוע מהנה',
  'שבוע קליל',
  'בהצלחה היום',
  
  // שאלות חברתיות
  'איך היה אתמול?',
  'נהנית בסופש?',
  'מה עשית בחופש?',
  'היה לך טוב?',
  'נהנית?',
  
  // תגובות קצרות יותר
  'נחמד',
  'יופי',
  'כיף לשמוע',
  'שמח לשמוע',
  'זה טוב',
  'נחמד מאוד',
  'אחלה',
  'מגניב',
  'יפה מאוד',
  'ממש יפה',
  
  // שאלות על מצב
  'איך אתה מחזיק מעמד?',
  'הכל מתנהל?',
  'אתה מצליח?',
  'יש התקדמות?',
  'איך זה הולך?',
  
  // עניינים כלליים
  'מה הסיפור?',
  'מה העניינים?',
  'מה פתאום?',
  'איך זה?',
  'למה כך?',
  
  // תגובות לחדשות
  'שמח לשמוע',
  'זה נהדר',
  'כיף לך',
  'מגיע לך',
  'אתה ראוי לכך',
  
  // המשך שיחה רגילה
  'מה אתה אומר על זה?',
  'מה דעתך בנושא?',
  'איך אתה רואה את זה?',
  'מה אתה חושב?',
  'איך לדעתך?',
  
  // עוד הודעות יומיומיות
  'בוקר של ראשון',
  'בוקר של שני',
  'בוקר של שלישי',
  'בוקר של רביעי',
  'בוקר של חמישי',
  'ערב טוב וחג שמח',
  'צום קל',
  'גמר חתימה טובה',
  
  // שיחות עבודה קלות
  'סיימת את זה?',
  'הצלחת?',
  'זה עבד?',
  'יצא טוב?',
  'הכל בסדר שם?',
  
  // תגובות חיוביות נוספות
  'שמח לשמוע שהכל טוב',
  'זה נשמע מעולה',
  'נחמד לדעת',
  'חשוב לדעת',
  'תודה על העדכון',
  
  // שאלות כלליות יותר
  'מה התכניות לחודש הבא?',
  'יש משהו חדש בחיים?',
  'מה קורה אצלכם?',
  'הכל רגוע?',
  'מה המצב בכלל?',
  
  // הודעות קצרות ומהירות
  'נו',
  'אז',
  'טוב',
  'יפה',
  'כן כן',
  'אוקיי אוקיי',
  'הבנתי',
  'בסדר',
  'מצוין',
  'אחלה',
  
  // שאלות על תחושות
  'איך אתה מרגיש לגבי זה?',
  'מה אתה חושב על העניין?',
  'זה מתאים לך?',
  'אתה בעד?',
  'מה העמדה שלך?',
  
  // עוד תגובות
  'זה נראה לי טוב',
  'נשמע סבבה',
  'אני מסכים איתך',
  'גם לי זה נראה ככה',
  'נכון מה שאתה אומר',
  
  // שיחות על מזג אוויר
  'איזה חום היום',
  'קר בחוץ',
  'יום יפה היום',
  'איזה מזג אוויר',
  'נעים בחוץ',
  
  // שאלות על לו"ז
  'מתי אתה חוזר?',
  'מתי תהיה פנוי?',
  'אתה בדרך?',
  'הגעת?',
  'איפה אתה נמצא?',
  
  // הודעות של המתנה
  'רגע, אני בודק',
  'תן לי שנייה',
  'רק רגע',
  'אני חוזר אליך',
  'אני בודק ומעדכן',
  
  // שאלות על רצונות
  'בא לך משהו?',
  'רוצה שנעשה משהו?',
  'מה אתה רוצה?',
  'איך תרצה?',
  'מה מתאים לך?',
  
  // תגובות להצעות
  'נשמע מעניין',
  'אולי, למה לא',
  'בוא ננסה',
  'אפשר',
  'אני בעד',
  
  // הודעות של סגירה
  'נשמע',
  'אז ככה',
  'בסדר אז',
  'מעולה',
  'יפה מאוד',
  
  // שאלות על מקום
  'איפה זה?',
  'איך מגיעים?',
  'רחוק?',
  'זה קרוב?',
  'איפה בדיוק?',
  
  // הודעות של אישור
  'קיבלתי',
  'הבנתי את זה',
  'ברור לי',
  'אוקיי, הבנתי',
  'סבבה, קלטתי',
  
  // שיחות על אוכל
  'אכלת כבר?',
  'מה אכלת?',
  'טעים?',
  'איפה אכלת?',
  'ממליץ?',
  
  // הודעות של עניין
  'באמת?',
  'רצינות?',
  'לא ידעתי',
  'וואו',
  'מעניין מאוד',
  'זה משהו',
  
  // שאלות כלליות נוספות
  'מה שלומך באמת?',
  'הכל טוב בעבודה?',
  'מתנהל?',
  'עסוק?',
  'יש זמן?',
  
  // תגובות לבעיות
  'זה יעבור',
  'תראה שזה יסתדר',
  'אל תדאג',
  'זה ישתפר',
  'תהיה בריא',
  
  // הודעות ארוכות יותר
  'אני חושב שזה רעיון טוב מה שהצעת',
  'שמעתי על זה וזה נשמע לי מעניין',
  'אני מסכים איתך לגמרי בנושא הזה',
  'זה באמת משהו שכדאי לשקול',
  'אני חושב שאתה צודק במה שאמרת',
  
  // עוד ברכות מיוחדות
  'מזל טוב!',
  'כל הכבוד!',
  'יישר כוח!',
  'אלוף!',
  'חזק!',
  'אתה גיבור',
  'כבוד',
  
  // שאלות מתקדמות
  'מה החדשות אצלך לאחרונה?',
  'יש משהו חדש ומעניין?',
  'מה עובר עליך בתקופה האחרונה?',
  'איך אתה מתמודד?',
  'אתה מצליח להתמודד?',
  
  // תגובות לשמיעה
  'שמח ששמעתי',
  'תודה שעדכנת',
  'נחמד לדעת',
  'חשוב שספרת',
  'טוב שאמרת',
  
  // המשך - הודעות נוספות
  'מה התכניות שלך?',
  'איך אתה מתכנן את זה?',
  'מה אתה הולך לעשות?',
  'איך תפעל?',
  'מה הצעד הבא?',
  
  // שאלות על הרגשה
  'אתה שמח עם זה?',
  'אתה מרוצה?',
  'זה טוב בשבילך?',
  'אתה נהנה?',
  'אתה מרגיש בנוח?',
  
  // עוד תגובות
  'זה מדהים',
  'לא ציפיתי',
  'זה הפתיע אותי',
  'מעניין לשמוע',
  'זה חדש בשבילי',
  
  // הודעות על זמינות
  'אני זמין',
  'אני פה',
  'אני פנוי',
  'תמיד אפשר',
  'בכל זמן',
  
  // שאלות על העדפות
  'מה אתה מעדיף?',
  'מה יותר טוב לך?',
  'איך נוח לך?',
  'מה מתאים יותר?',
  'איזה אופציה עדיפה?',
  
  // תגובות להצעות
  'בוא נשמע',
  'למה לא',
  'אפשר לנסות',
  'יאללה בוא',
  'אני בעניין',
  
  // עוד הודעות יומיומיות
  'איך הכושר?',
  'עשית ספורט?',
  'יצאת מהבית?',
  'היה לך כיף?',
  'מה עשית?',
  
  // שאלות על תוכניות
  'יש לך תכנית?',
  'מה החשבון?',
  'איך נקדם את זה?',
  'מה הלאה?',
  'איך ממשיכים?',
  
  // תגובות חיוביות נוספות
  'אני שמח בשבילך',
  'כיף לך',
  'תהנה',
  'זה יפה',
  'איזה כיף',
  
  // עוד שאלות
  'למה?',
  'איך?',
  'מתי?',
  'איפה?',
  'עם מי?',
  
  // הודעות של סקרנות
  'ספר לי יותר',
  'מה הסיפור המלא?',
  'תפרט קצת',
  'איך זה קרה?',
  'מה הרקע?',
  
  // תגובות להמתנה
  'בסדר, אני מחכה',
  'אין בעיה, אני פה',
  'קח את הזמן שלך',
  'בלי לחץ',
  'בסדר גמור',
  
  // הודעות של התעניינות
  'מה קורה שם?',
  'מה המצב אצלכם?',
  'איך זה הולך שם?',
  'הכל בסדר בבית?',
  'מה שלום כולם?',
  
  // עוד תגובות
  'שמחתי לשמוע',
  'נחמד מאוד',
  'זה טוב',
  'יפה',
  'מעולה',
  
  // שאלות פרקטיות
  'איך עושים את זה?',
  'מה צריך?',
  'איפה זה נמצא?',
  'איך מגיעים לשם?',
  'מה עושים עם זה?',
  
  // תגובות להסכמה
  'בוא נעשה ככה',
  'מסכים',
  'זה עובד לי',
  'אני איתך בזה',
  'בטח',
  
  // הודעות של עידוד נוספות
  'אתה יכול',
  'תצליח בוודאות',
  'אין ספק',
  'בטוח שכן',
  'זה יצא טוב',
  
  // שיחות כלליות
  'מה הולך?',
  'מה התוכניות?',
  'יש משהו מיוחד?',
  'מה קורה בחיים?',
  'מה עובר עליך?',
  
  // תגובות קצרות נוספות
  'נכון',
  'בול',
  'מדויק',
  'בדיוק',
  'ממש',
  'נכון מאוד',
  'אכן',
  'כן כן',
  
  // שאלות על בריאות
  'אתה בריא?',
  'הכל בסדר בריאותית?',
  'אתה מרגיש טוב?',
  'לא חולה?',
  'נרגע?',
  
  // הודעות של התחלה
  'בוא נתחיל',
  'יאללה קדימה',
  'בוא נעשה את זה',
  'בואו נתקדם',
  'נתחיל?',
  
  // תגובות לעצות
  'תודה על העצה',
  'זה עוזר',
  'חשבתי על זה',
  'זה רעיון טוב',
  'אני אנסה את זה',
  
  // עוד שאלות מעשיות
  'כמה זה עולה?',
  'מתי זה יהיה?',
  'איפה זה קורה?',
  'מי יהיה שם?',
  'מי מארגן?',
  
  // הודעות של הודיה
  'תודה על הכל',
  'אני מעריך את זה מאוד',
  'תודה שעזרת',
  'זה ממש עזר לי',
  'אני אסיר תודה',
  
  // שאלות על דעות
  'איך זה לדעתך?',
  'מה אתה אומר?',
  'איך זה נשמע?',
  'מה דעתך על זה?',
  'איך את/ה רואה את זה?',
  
  // תגובות להפתעות
  'לא ידעתי את זה',
  'זו חדשה בשבילי',
  'ממש הפתעה',
  'לא ציפיתי לזה',
  'זה מפתיע',
  
  // הודעות כלליות נוספות
  'איך היה לך?',
  'מה היה?',
  'ספר מה קרה',
  'מה התרחש?',
  'איך זה התפתח?',
  
  // עוד תגובות חיוביות
  'גאה בך',
  'מרשים',
  'יפה מאוד ממך',
  'כל הכבוד ממש',
  'אתה מדהים',
  
  // שאלות על הבנה
  'אתה מבין?',
  'זה ברור?',
  'הכל ברור לך?',
  'יש שאלות?',
  'אתה עוקב?',
  
  // תגובות להבנה
  'הבנתי בול',
  'ברור לי לגמרי',
  'קלטתי',
  'הגיוני',
  'עכשיו ברור',
  
  // עוד הודעות של סיום
  'אז נדבר',
  'נשמע בהמשך',
  'נתעדכן',
  'בהצלחה בינתיים',
  'שיהיה לך טוב',
  
  // שאלות על חוויות
  'איך היה לך שם?',
  'נהנית מזה?',
  'היה שווה?',
  'כיף היה?',
  'מה אתה יכול להגיד?',
  
  // תגובות לשמחה
  'שמח לשמוע שאתה טוב',
  'נעים לדעת שהכל בסדר',
  'כיף לדעת',
  'חשוב לדעת שאתה מרוצה',
  
  // עוד הודעות יומיומיות
  'מה המצב בעבודה?',
  'איך הפרויקט?',
  'הצלחת לסיים?',
  'התקדמת?',
  'יש חדשות בעבודה?',
  
  // שאלות על משפחה
  'איך המשפחה?',
  'מה שלום כולם בבית?',
  'הכל טוב אצלכם?',
  'איך הילדים מתנהלים?',
  'מה שלום הזוגה?',
  
  // תגובות נוספות
  'זה נחמד',
  'ממש יפה',
  'אחלה של דבר',
  'זה ממש טוב',
  'מעולה לשמוע',
  
  // עוד שאלות
  'יש מה לספר?',
  'מה יש לעדכן?',
  'יש חדשות?',
  'מה חדש בעולמך?',
  'יש משהו חדש?',
  
  // הודעות של התחשבות
  'אני מקווה שלא הפרעתי',
  'מקווה שזה זמן טוב',
  'אפשר לדבר?',
  'אתה יכול עכשיו?',
  'זמן טוב?',
  
  // תגובות חברתיות
  'נעים מאוד',
  'שמחתי להכיר',
  'כיף שיחה',
  'היה נחמד',
  'נעים היה',
  
  // עוד שאלות על תכניות
  'מה בראש?',
  'מה החשיבה?',
  'איך אתה רואה את זה?',
  'מה האסטרטגיה?',
  'מה הגישה?',
  
  // הודעות של הבנה
  'אני מבין אותך',
  'ברור לי למה',
  'זה הגיוני',
  'הבנתי את הנקודה',
  'זה מובן',
  
  // עוד תגובות קצרות
  'יופי של יופי',
  'סבבה של סבבה',
  'אחלה של אחלה',
  'מעולה של מעולה',
  'טוב מאוד',
  
  // שאלות על עזרה
  'צריך עזרה?',
  'אני יכול לעזור?',
  'רוצה שאעזור?',
  'במה אני יכול לסייע?',
  'יש משהו שאני יכול לעשות?',
  
  // תגובות להצלחה
  'כל הכבוד שהצלחת',
  'מרשים שעשית את זה',
  'יפה מאוד ממך שהגעת',
  'אלוף על ההשגה',
  
  // עוד הודעות כלליות
  'מה המצב היום?',
  'איך היום שלך?',
  'יום טוב היה?',
  'עשית משהו?',
  'מה היה אצלך?',
  
  // שאלות על רגשות
  'אתה מרגיש טוב עם זה?',
  'זה מרגיש נכון?',
  'אתה שמח?',
  'אתה מרוצה מהמצב?',
  'זה טוב עבורך?',
  
  // תגובות לבקשות
  'בטח, בלי בעיה',
  'כמובן',
  'ברור שכן',
  'אין שום בעיה',
  'בשמחה',
  
  // עוד הודעות
  'מה אתה עושה עכשיו?',
  'איפה אתה נמצא כרגע?',
  'אתה בדרך?',
  'הגעת למקום?',
  'אתה שם?',
  
  // שאלות על תחום
  'איך זה בתחום שלך?',
  'מה קורה בעבודה?',
  'איך הפרויקט מתקדם?',
  'יש עדכונים?',
  'מה חדש בעניינים?',
  
  // תגובות לתודה
  'בכיף',
  'אין על מה',
  'תמיד',
  'בשמחה לעזור',
  'זה מה שיש',
  
  // עוד שאלות כלליות
  'מה דעתך על המצב?',
  'איך אתה מעריך את זה?',
  'מה חושבים על זה?',
  'איך זה נראה לך?',
  'מה אתה אומר לזה?',
  
  // הודעות של אופטימיות
  'זה יהיה בסדר',
  'תראה שזה יסתדר',
  'הכל יעבוד',
  'אל תדאג, יצא טוב',
  'תהיה שקט, זה יצליח',
  
  // שאלות על איכות
  'זה טוב?',
  'זה באיכות?',
  'זה שווה?',
  'זה מה שרצית?',
  'אתה מרוצה מזה?',
  
  // עוד תגובות
  'כן, בדיוק',
  'זה מדויק',
  'נכון לגמרי',
  'בול פגיעה',
  'ממש ככה',
  
  // הודעות של זכירה
  'זוכר שדיברנו על זה?',
  'זוכר את זה?',
  'אתה זוכר?',
  'נזכר?',
  'היה לנו את זה',
  
  // עוד שאלות מעניינות
  'מה דעתך על המצב הכללי?',
  'איך אתה רואה את העתיד?',
  'מה התכניות לטווח ארוך?',
  'לאן אתה הולך עם זה?',
  'מה הכיוון?',
  
  // תגובות לשמיעת חדשות טובות
  'שמח לשמוע שזה עובד',
  'נהדר שזה התאים',
  'יופי שזה הצליח',
  'טוב שזה יצא',
  'אחלה שזה קרה',
  
  // הודעות של קבלה
  'קיבלתי את זה',
  'הגיע אלי',
  'ראיתי',
  'עברתי על זה',
  'קראתי',
  
  // שאלות על פרטים
  'מה הפרטים?',
  'איך בדיוק?',
  'תן לי את כל המידע',
  'מה כל העניין?',
  'מה כל הסיפור?',
  
  // עוד תגובות מעודדות
  'תמשיך ככה',
  'אתה בכיוון הנכון',
  'זה הדרך',
  'המשך',
  'אל תעצור',
  
  // הודעות של סבלנות
  'אני מבין',
  'זה קורה',
  'זה בסדר',
  'אל תדאג מזה',
  'זה חלק מהתהליך',
  
  // שאלות על השפעה
  'זה השפיע?',
  'זה עזר?',
  'זה שינה משהו?',
  'הרגשת הבדל?',
  'זה עבד?',
  
  // עוד תגובות כלליות
  'מעניין לדעת',
  'טוב לדעת את זה',
  'חשוב להכיר',
  'שווה לזכור',
  'כדאי לדעת',
  
  // הודעות של המשך יום
  'אז מה היום?',
  'מה בתכנית?',
  'יש משהו מיוחד היום?',
  'מה עושים היום?',
  'מה קורה היום?',
  
  // שאלות על תחושות נוספות
  'מרגיש טוב עם זה?',
  'אתה רגוע?',
  'אתה שקט?',
  'הכל בשליטה?',
  'אתה מרגיש בטוח?',
  
  // עוד תגובות קצרות
  'נחמד נחמד',
  'יפה יפה',
  'טוב טוב',
  'אחלה אחלה',
  'כיף כיף',
  
  // הודעות של סיכום
  'אז לסכם',
  'בקיצור',
  'התמונה המלאה',
  'בגדול',
  'ככה זה',
  
  // שאלות על זמינות נוספות
  'אתה יכול מחר?',
  'פנוי בשבוע הבא?',
  'מתי תהיה זמין?',
  'יש לך זמן בקרוב?',
  'אפשר לתאם?',
  
  // תגובות חיוביות נוספות
  'זה מדליק',
  'זה ממש טוב',
  'זה נראה נהדר',
  'זה נשמע מושלם',
  'זה בול מה שצריך',
  
  // הודעות של התייעצות
  'מה אתה חושב שכדאי?',
  'לדעתך מה עדיף?',
  'איך היית עושה?',
  'מה ההמלצה שלך?',
  'מה אתה מציע?',
  
  // עוד שאלות יומיומיות
  'שתית קפה?',
  'יצאת לאוויר?',
  'עשית הפסקה?',
  'נחת קצת?',
  'יש לך רגע?',
  
  // תגובות להזמנות
  'אשמח מאוד',
  'בטח, למה לא',
  'נשמע כיפי',
  'אני בעניין',
  'בוא נעשה את זה',
  
  // הודעות של עניין מתמשך
  'אז מה בסוף?',
  'ומה היה?',
  'איך זה נגמר?',
  'מה התוצאה?',
  'איך זה הסתיים?',
  
  // שאלות על רצונות נוספות
  'בא לך?',
  'אתה רוצה?',
  'מעניין אותך?',
  'זה משהו שמדבר אליך?',
  'אתה מעוניין?',
  
  // עוד תגובות
  'זה מצחיק',
  'זה מבדר',
  'זה כיף',
  'זה נחמד',
  'זה נעים',
  
  // הודעות של תמיכה
  'אני כאן בשבילך',
  'אם צריך אותי',
  'תמיד אפשר לדבר',
  'אני זמין לעזור',
  'בכל עניין',
  
  // שאלות על התקדמות
  'איך זה מתקדם?',
  'יש התקדמות?',
  'זה זז?',
  'יש תנועה?',
  'זה קורה?',
  
  // עוד תגובות לשמחה
  'שמחתי מאוד',
  'כיף גדול',
  'ממש כיף',
  'זה היה נהדר',
  'היה מעולה',
  
  // הודעות של ציפייה
  'מחכה לשמוע',
  'סקרן לדעת',
  'מעניין אותי',
  'רוצה לשמוע',
  'ספר כשתוכל',
  
  // שאלות על אפשרויות
  'יש אופציות?',
  'מה האפשרויות?',
  'מה יכול להיות?',
  'יש עוד רעיונות?',
  'מה עוד?',
  
  // תגובות לרעיונות
  'רעיון טוב',
  'זה יכול לעבוד',
  'נשמע הגיוני',
  'אפשר לנסות',
  'למה לא',
  
  // הודעות של עניין כללי
  'מה קורה בעולם?',
  'יש משהו מעניין?',
  'מה החדשות?',
  'שמעת משהו?',
  'יש מה לספר?',
  
  // עוד שאלות על מצב רוח
  'אתה שמח היום?',
  'מצב רוח טוב?',
  'הכל בסדר נפשית?',
  'אתה רגוע?',
  'הכל טוב בראש?',
  
  // תגובות לסיפורים
  'זה סיפור',
  'איזה סיפור',
  'לא ייאמן',
  'משהו',
  'חזק',
  
  // הודעות של המתנה נוספות
  'אני מחכה',
  'תגיד לי',
  'עדכן אותי',
  'תן לי לדעת',
  'אני אחכה לשמוע',
  
  // שאלות על הערכות
  'מה אתה מעריך?',
  'כמה זמן לדעתך?',
  'מה הסיכויים?',
  'איך זה נראה?',
  'מה התחזית?',
  
  // עוד תגובות מעודדות
  'תמשיך חזק',
  'קדימה',
  'אתה על זה',
  'תתפוס אותה',
  'לך על זה',
  
  // הודעות של סקרנות נוספות
  'מה התוכן?',
  'מה הנושא?',
  'על מה זה?',
  'מה העניין?',
  'מה הקטע?',
  
  // תגובות לתכניות
  'נשמע כמו תכנית',
  'זה תכנית טובה',
  'אני עם זה',
  'זה יכול לצאת טוב',
  'בוא נראה',
  
  // הודעות של בדיקה
  'הכל עובד?',
  'זה תקין?',
  'אין בעיות?',
  'הכל מתפקד?',
  'עובד טוב?',
  
  // שאלות על דרכים
  'איך עושים את זה?',
  'מה הדרך?',
  'איך מגיעים?',
  'מה השיטה?',
  'איך ניגשים?',
  
  // עוד תגובות חיוביות
  'אחלה עליך',
  'כל הכבוד לך',
  'יופי עבודה',
  'מרשים ממך',
  'יפה מאוד עשית',
  
  // הודעות של שיתוף
  'ספר לי איך היה',
  'שתף אותי',
  'תעדכן אותי',
  'תספר מה קרה',
  'אני רוצה לשמוע',
  
  // שאלות על הקשר
  'מה הקשר?',
  'איך זה קשור?',
  'מה הרלוונטיות?',
  'למה זה חשוב?',
  'מה החשיבות?',
  
  // עוד תגובות כלליות
  'זה דבר',
  'משהו שווה',
  'זה ראוי',
  'זה כדאי',
  'זה נחוץ',
  
  // הודעות של הסכמה
  'אני איתך בזה',
  'תומך בך',
  'אני לצדך',
  'אני מאחוריך',
  'אתה לא לבד',
  
  // שאלות על עדכונים
  'יש עדכון?',
  'מה השלב?',
  'איפה אנחנו?',
  'מה הסטטוס?',
  'איפה עומדים?',
  
  // תגובות לסיפורי הצלחה
  'שמח שהצלחת',
  'כל הכבוד על ההישג',
  'מרשים מה שעשית',
  'יפה מאוד שהגעת',
  'אלוף על זה',
  
  // עוד הודעות יומיומיות
  'מה אכלת היום?',
  'שתית משהו?',
  'נחת קצת?',
  'ישנת טוב?',
  'קמת בזמן?',
  
  // שאלות על סיכויים
  'מה הסיכוי?',
  'מה החלון?',
  'יש אפשרות?',
  'זה ריאלי?',
  'זה אפשרי?',
  
  // עוד תגובות
  'אני שמח בשבילך מאוד',
  'ממש כיף לך',
  'זה נחמד ממך',
  'אני מעריך מאוד',
  'תודה על זה',
  
  // הודעות של תיאום
  'בוא נתאם',
  'צריך לתאם',
  'נסדר את זה',
  'נארגן',
  'נקבע',
  
  // שאלות על ביצוע
  'עשית את זה?',
  'הצלחת?',
  'יצא?',
  'זה קרה?',
  'נגמר?',
  
  // עוד תגובות חיוביות
  'ממש מעולה',
  'זה פצצה',
  'זה מושלם',
  'זה על הפנים',
  'זה גאוני',
  
  // הודעות של המשך
  'אז מה עכשיו?',
  'מה הלאה מכאן?',
  'לאן מפה?',
  'מה עושים עכשיו?',
  'מה הצעד הבא?',
  
  // שאלות על הרגשה כללית
  'אתה מרגיש טוב בכללי?',
  'הכל זורם?',
  'אתה במצב טוב?',
  'אתה נהנה?',
  'זה טוב לך?',
  
  // עוד תגובות
  'זה נראה לי נכון',
  'אני חושב שזה טוב',
  'נראה שזה עובד',
  'נדמה שזה בסדר',
  'לדעתי זה מצוין',
  
  // הודעות של סיום שיחה
  'טוב, נשמע',
  'אז ככה זה',
  'בסדר, הבנתי',
  'אוקיי, תודה',
  'יפה, נדבר',
  
  // שאלות על זמן נוספות
  'מתי זה היה בדיוק?',
  'איזו שעה?',
  'באיזה יום?',
  'מתי הדבר הזה קרה?',
  'בכמה זה היה?',
  
  // עוד תגובות מעניינות
  'זה ממש מעניין',
  'לא ידעתי שזה ככה',
  'זה חדש',
  'זו חדשה',
  'זה משהו חדש',
  
  // הודעות של הבנה מעמיקה
  'אני מבין לגמרי',
  'ברור לי את כל הנושא',
  'הבנתי את כל העניין',
  'זה ברור לי עכשיו',
  'עכשיו אני רואה',
  
  // שאלות על פעולות
  'מה עשית עם זה?',
  'איך טיפלת בזה?',
  'מה היה הטיפול?',
  'איך פתרת?',
  'מה עשית בסוף?',
  
  // עוד תגובות תומכות
  'אני תומך בך',
  'אני איתך',
  'אני לצדך בזה',
  'אתה יכול לסמוך עלי',
  'אני כאן',
  
  // הודעות של אישור קבלה
  'הבנתי ממך',
  'קלטתי',
  'ברור',
  'אוקיי הבנתי',
  'יש לי את זה',
  
  // שאלות על רמות
  'באיזה רמה?',
  'באיזה שלב?',
  'איפה זה נמצא?',
  'מה המצב?',
  'איך זה נראה?',
  
  // עוד תגובות מעודדות
  'אתה עושה עבודה נהדרת',
  'ממש יפה ממך',
  'אתה בכיוון מצוין',
  'המשך בדרך הזו',
  'זו הדרך הנכונה',
  
  // הודעות של שמחה
  'שמח מאוד לשמוע',
  'כיף לדעת',
  'ממש כיף',
  'אני שמח',
  'זה משמח',
  
  // שאלות על בחירות
  'מה בחרת?',
  'מה החלטת?',
  'לאן הלכת?',
  'מה עשית?',
  'איך פעלת?',
  
  // עוד תגובות חיוביות
  'זה מושלם לגמרי',
  'בדיוק מה שצריך',
  'זה בול',
  'זה מדויק',
  'זה בדיוק נכון',
  
  // הודעות של התעדכנות
  'עדכן אותי איך זה הולך',
  'תספר לי מה קרה',
  'תן לי לדעת איך זה',
  'אני רוצה לדעת',
  'שמור אותי מעודכן',
  
  // שאלות על סיבות
  'למה זה קרה?',
  'מה הסיבה?',
  'איך זה נוצר?',
  'מה גרם לזה?',
  'למה בכלל?',
  
  // עוד תגובות
  'זה נראה מעולה',
  'זה נשמע נהדר',
  'זה מרגיש נכון',
  'זה בול מה שצריך היה',
  'זה בדיוק זה',
  
  // הודעות של המשך עבודה
  'בוא נמשיך',
  'קדימה הלאה',
  'נמשיך לעבוד',
  'בואו נתקדם',
  'הלאה',
  
  // שאלות על תוצאות
  'מה התוצאות?',
  'מה יצא?',
  'איך זה הסתיים?',
  'מה הפלט?',
  'מה קיבלת?',
  
  // עוד תגובות סיכום
  'זה הכל',
  'זה מסכם',
  'זה זה',
  'ככה זה',
  'זה בדיוק',
  
  // הודעות של הערכה
  'מעריך את העזרה',
  'תודה על התמיכה',
  'זה עזר מאוד',
  'היה נחוץ',
  'תודה רבה על זה',
  
  // שאלות על כמות
  'כמה זה?',
  'מה הכמות?',
  'כמה יש?',
  'מה המספר?',
  'כמה זה יוצא?',
  
  // עוד תגובות חיוביות
  'אחלה של עבודה',
  'עבודה מצוינת',
  'זה עבודה טובה',
  'ממש יפה עבדת',
  'כל הכבוד על העבודה',
  
  // הודעות של בקשה
  'אפשר בקשה?',
  'יש לך רגע?',
  'אפשר טובה?',
  'תעשה לי טובה?',
  'אני צריך עזרה קטנה',
  
  // שאלות על השוואה
  'מה עדיף?',
  'מה יותר טוב?',
  'איזה יותר מתאים?',
  'מה הבחירה הטובה?',
  'לאיזה כיוון?',
  
  // עוד תגובות
  'זה בול זה',
  'בדיוק כך',
  'ממש מדויק',
  'זה זה בול',
  'זה בדיוק מה שחשבתי',
  
  // הודעות של שמירת קשר
  'נהיה בקשר',
  'נדבר בקרוב',
  'אני אחזור אליך',
  'נשמע שוב',
  'נתעדכן בהמשך',
  
  // שאלות על איכויות
  'זה איכותי?',
  'זה טוב?',
  'זה ברמה?',
  'זה שווה?',
  'זה מספיק טוב?',
  
  // עוד תגובות לשמחה
  'כיף גדול לשמוע',
  'שמח מאוד על זה',
  'זה ממש משמח',
  'שמחה גדולה',
  'כיף לדעת את זה',
  
  // הודעות של סגירה
  'נסגר',
  'זהו',
  'סוגרים',
  'זה סוגר את זה',
  'זה מסכם הכל',
  
  // שאלות על הבדלים
  'מה ההבדל?',
  'מה משתנה?',
  'מה השוני?',
  'מה החידוש?',
  'מה חדש כאן?',
  
  // עוד תגובות
  'זה עובד מעולה',
  'זה מתאים בול',
  'זה בדיוק מה שצריך',
  'זה פותר את זה',
  'זה עונה על השאלה',
  
  // הודעות של אישור
  'אישרתי',
  'עשיתי',
  'קיבלתי',
  'ראיתי את זה',
  'הבנתי את זה',
  
  // שאלות על מטרות
  'מה המטרה?',
  'לאן רוצים להגיע?',
  'מה היעד?',
  'מה התוחלת?',
  'מה הציפייה?',
  
  // עוד תגובות חיוביות
  'ממש אחלה דבר',
  'זה סופר',
  'זה גדול',
  'זה חזק',
  'זה עוצמה',
  
  // הודעות של המלצה
  'אני ממליץ על זה',
  'זה שווה',
  'כדאי לנסות',
  'תנסה את זה',
  'זה ממש טוב',
  
  // שאלות על הרגלים
  'אתה עושה את זה תמיד?',
  'זה הרגל שלך?',
  'אתה נוהג ככה?',
  'זו הדרך שלך?',
  'ככה אתה תמיד?',
  
  // עוד תגובות
  'זה בסדר גמור',
  'אין שום בעיה עם זה',
  'זה מקובל',
  'זה בסדר ממש',
  'אין דבר',
  
  // הודעות של פרטים
  'תן לי את הפרטים',
  'מה המידע?',
  'איך זה בדיוק?',
  'מה כל העניין?',
  'ספר את כל הסיפור',
  
  // שאלות על דרישות
  'מה צריך בשביל זה?',
  'מה הדרישות?',
  'מה חסר?',
  'מה עוד נחוץ?',
  'מה צריך להשלים?',
  
  // עוד תגובות מעודדות
  'כל הכבוד ממש ממש',
  'אלוף גדול',
  'זה ברמה גבוהה',
  'זה מקצועי',
  'עבודה מדהימה',
  
  // הודעות של שיתוף פעולה
  'בוא נעשה ביחד',
  'נעבוד על זה',
  'נתאגד',
  'נשלב כוחות',
  'ביחד זה עובד',
  
  // שאלות על אפשרויות נוספות
  'מה עוד אפשר?',
  'יש עוד דרכים?',
  'מה החלופות?',
  'יש אופציות נוספות?',
  'מה עוד יכול להיות?',
  
  // עוד תגובות
  'זה נכון לחלוטין',
  'ממש בול',
  'בדיוק בול',
  'מדויק לגמרי',
  'זה ממש זה',
  
  // הודעות של אופטימיות
  'זה יהיה טוב',
  'תראה שזה יעבוד',
  'זה יצליח',
  'אני בטוח בזה',
  'זה יצא מעולה',
  
  // שאלות על קושי
  'זה קשה?',
  'זה מסובך?',
  'זה פשוט?',
  'זה קל?',
  'זה אתגרי?',
  
  // עוד תגובות לסיפורים
  'וואו זה סיפור',
  'איזה סיפור מטורף',
  'לא ייאמן',
  'זה משהו',
  'זה חזק מאוד',
  
  // הודעות של התמדה
  'תמשיך עם זה',
  'אל תוותר',
  'קדימה זה עובד',
  'המשך ככה',
  'אתה על הדרך',
  
  // שאלות על ביצועים
  'איך זה עובד?',
  'זה פועל טוב?',
  'זה עושה את העבודה?',
  'זה מתפקד?',
  'זה יעיל?',
  
  // עוד תגובות סיכום
  'סיכמנו',
  'הבנו',
  'התאמנו',
  'הסכמנו',
  'זה מוסכם',
  
  // הודעות של עזרה נוספת
  'אפשר לעזור עוד?',
  'צריך משהו נוסף?',
  'יש עוד משהו?',
  'מה עוד?',
  'במה עוד?',
  
  // שאלות על מסקנות
  'אז מה המסקנה?',
  'מה אנחנו לומדים מזה?',
  'מה הלקח?',
  'מה אפשר להסיק?',
  'מה העיקר?',
  
  // עוד תגובות
  'זה מצוין לגמרי',
  'זה באמת טוב',
  'זה ממש עובד',
  'זה פותר',
  'זה עונה',
  
  // הודעות של המשך תכנון
  'מה התוכנית המדויקת?',
  'איך נפעל?',
  'מה השלבים?',
  'איך מתחילים?',
  'מה עושים ראשון?',
  
  // שאלות על משמעות
  'מה המשמעות?',
  'מה זה אומר?',
  'איך מפרשים את זה?',
  'מה ההשלכות?',
  'מה הנפקות?',
  
  // עוד תגובות חיוביות
  'זה נהדר באמת',
  'זה ממש ממש טוב',
  'זה מושלם ממש',
  'זה לא יכול להיות יותר טוב',
  'זה בול מה שצריך היה',
  
  // הודעות של תמיכה נוספות
  'אני פה בשבילך תמיד',
  'תמיד אפשר לפנות אלי',
  'אני זמין בכל זמן',
  'אם צריך משהו אני כאן',
  'בכל עניין אני פה',
  
  // שאלות על עתיד
  'מה יהיה?',
  'לאן זה הולך?',
  'מה צפוי?',
  'מה בעתיד?',
  'מה הלאה?',
  
  // עוד תגובות
  'זה באמת מעניין מאוד',
  'זה משהו שכדאי לשקול',
  'זה ראוי למחשבה',
  'זה נושא חשוב',
  'זה משמעותי',
  
  // הודעות של סיום חיובי
  'היה ממש כיף',
  'תודה על השיחה',
  'נעים היה לדבר',
  'כיף היה',
  'שיחה נעימה',
  
  // שאלות על מקום נוספות
  'איזה מקום?',
  'איפה בדיוק זה?',
  'זה איפה?',
  'באיזו עיר?',
  'באיזה אזור?',
  
  // עוד תגובות אופטימיות
  'הכל יסתדר בסוף',
  'תראה שיהיה בסדר',
  'אני בטוח שזה יעבוד',
  'זה בטוח יצליח',
  'אני מאמין בזה',
  
  // הודעות של זכירה
  'תזכיר לי',
  'תן לי להזכיר',
  'רק להזכיר',
  'כדאי לזכור',
  'חשוב לזכור',
  
  // שאלות על בעיות
  'יש בעיה?',
  'משהו לא בסדר?',
  'יש תקלה?',
  'זה עובד?',
  'הכל תקין?',
  
  // עוד תגובות
  'זה נראה לי מצוין',
  'אני חושב שזה טוב מאוד',
  'לדעתי זה בול',
  'נראה שזה נכון',
  'זה נשמע נכון לגמרי',
  
  // הודעות של שיתוף רגשות
  'אני מרגיש טוב עם זה',
  'זה מרגיש נכון לי',
  'אני שמח עם זה',
  'זה טוב לי',
  'אני מרוצה מזה',
  
  // הודעות ארוכות - שיחות טבעיות
  'היי, מה נשמע? מזמן לא דיברנו, מקווה שהכל טוב אצלך ושהמשפחה בריאה',
  'שלום! רציתי לשאול איך עבר לך השבוע? אני מקווה שהיה לך זמן קל ושלא היו יותר מדי דברים לחץ',
  'מה קורה? אני חושב עליך והתעניינתי איך הולכים הדברים אצלך בתקופה האחרונה',
  'היי, איך אתה? שמעתי שיש לך הרבה על הראש לאחרונה, מקווה שאתה מצליח להתמודד עם הכל',
  'בוקר טוב! מקווה שהיום יהיה לך יום פרודוקטיבי ונעים, ושתצליח להשיג את כל מה שתכננת',
  'ערב טוב, איך היה היום? מקווה שהיה לך יום טוב ושהצלחת להשלים את כל מה שרצית',
  'שבת שלום! מקווה שתהיה לך מנוחה נעימה ושתצליח להירגע קצת מהשבוע המטורף',
  'היי חבר, מזמן לא התעדכנו. יש לך משהו מעניין לספר? אני סקרן לדעת מה קורה אצלך',
  'מה המצב? ראיתי את מה שכתבת ופשוט רציתי להגיד שאני חושב שזה ממש מעניין ושווה להמשיך עם זה',
  'שלום רב! רציתי לבדוק איתך לגבי הנושא שדיברנו עליו, האם יש לך עדכונים או התקדמות בעניין?',
  
  // הודעות ארוכות על תכניות
  'אז מה התכניות שלך לסוף השבוע? אני חושב לעשות משהו מיוחד אבל עדיין לא החלטתי מה בדיוק',
  'היי, רציתי לשאול אם יש לך תכניות ליום ראשון? אולי נוכל להיפגש ולעשות משהו ביחד',
  'מה אתה אומר על להיפגש בשבוע הבא? אני חושב שזה יהיה כיף ושנוכל לדבר על כל מיני דברים',
  'אני חושב שכדאי שנתאם פגישה בקרוב, יש הרבה דברים שאני רוצה לדבר איתך עליהם',
  'רציתי לשאול אם אתה פנוי מחר אחר הצהריים? חשבתי שאולי נוכל להיפגש לקפה ולעדכן אחד את השני',
  
  // הודעות ארוכות על עבודה
  'איך הולך הפרויקט שעליו דיברת? אני סקרן לדעת אם הצלחת להתקדם ואם יש משהו שאני יכול לעזור בו',
  'מה המצב בעבודה? אני זוכר שסיפרת שיש לך תקופה עמוסה, מקווה שאתה מצליח להתמודד עם הכל',
  'שמעתי שיש לך פרויקט חדש, זה נשמע ממש מעניין. תוכל לספר לי עוד פרטים כשיהיה לך זמן?',
  'איך העבודה בכלל לאחרונה? אני מקווה שהכל זורם ושאתה מצליח להשיג את היעדים שהצבת לעצמך',
  'רציתי לשאול איך התכנית החדשה בעבודה עובדת עבורך? אני מקווה שזה משהו שמתאים לך ושאתה נהנה ממנו',
  
  // הודעות ארוכות על חוויות
  'איך היה לך באירוע אתמול? אני שמעתי שזה היה ממש מעניין ורציתי לדעת מה אתה חושב',
  'נהנית מהסוף שבוע? עשית משהו מיוחד או פשוט נחת? לפעמים מנוחה זה בדיוק מה שצריך',
  'איך היה לך בחופשה? אני מקווה שהצלחת להירגע ולהנות קצת, אתה ממש מגיע לזה אחרי התקופה העמוסה',
  'שמעתי שהיית באירוע המשפחתי, איך היה? מקווה שנהנית ושהיה כיף לראות את כולם',
  'מה אתה אומר על הארוע שהיה? אני חושב שזה היה ארגון מצוין ושהכל יצא ממש יפה',
  
  // הודעות ארוכות על תכנון עתידי
  'אני חושב שכדאי שנתחיל לתכנן את הדבר הזה מראש, מה דעתך שנשב בקרוב ונעבור על כל הפרטים?',
  'לגבי מה שדיברנו, אני חושב שזה רעיון מעולה ושכדאי לנו להתחיל לעבוד על זה ברצינות',
  'מה אתה אומר על להתחיל לקדם את זה בשבועות הקרובים? אני חושב שיש לנו חלון הזדמנויות טוב',
  'רציתי להציע שנעשה את זה בצורה מסודרת ומתוכננת, מה דעתך? אני חושב שככה יהיה לנו יותר סיכוי להצליח',
  'אני חושב שאם נתכנן את זה נכון ונתחיל בזמן, נוכל לעשות משהו ממש מעניין ומוצלח',
  
  // הודעות ארוכות על תמיכה
  'רק רציתי להגיד לך שאני ממש מעריך את מה שאתה עושה ושאני חושב שאתה עושה עבודה מצוינת',
  'תדע לך שאם תצטרך משהו או עזרה בכל נושא, אני פה ותמיד אשמח לעזור בכל דרך שאני יכול',
  'אני רוצה שתדע שאני מאמין בך ובכישורים שלך, ואני בטוח שתצליח בכל מה שאתה שם לעצמך כמטרה',
  'אל תהסס לפנות אלי אם יש לך שאלות או אם אתה צריך עזרה, אני תמיד כאן ואשמח לסייע',
  'אני רוצה להגיד לך שאתה עושה עבודה נהדרת ושאני ממש גאה בהתקדמות שלך',
  
  // הודעות ארוכות על חוויות משותפות
  'זוכר כשדיברנו על זה לפני כמה זמן? אני חושב שבסוף אתה צדקת ושהדברים התפתחו בדיוק כמו שאמרת',
  'הייתי חושב על מה שאמרת בפעם הקודמת, ואני חייב להודות שיש בזה הרבה היגיון ושכדאי להתייחס לזה ברצינות',
  'אני זוכר שסיפרת לי על זה, ועכשיו כשאני רואה את זה קורה אני מבין בדיוק על מה דיברת',
  'זה מזכיר לי את מה שעברנו יחד בעבר, ואני חייב להגיד שזה היה ממש חוויה מעניינת',
  'כשאתה מספר על זה, זה מזכיר לי כמה דברים דומים שעברתי וזה ממש מעניין לראות את ההקבלה',
  
  // הודעות ארוכות על המלצות
  'אני ממש ממליץ לך לנסות את זה, לדעתי זה משהו שיכול להתאים לך מאוד ושתהנה ממנו',
  'שמעתי המון דברים טובים על זה ואני חושב שכדאי שתבדוק את זה כי זה נשמע ממש מתאים למה שאתה מחפש',
  'אם אתה שואל את דעתי, אני חושב שזו בחירה מצוינת ושאתה עושה את הדבר הנכון',
  'לפי מה ששמעתי וקראתי, זה נראה כמו אופציה ממש טובה ושכדאי לשקול את זה ברצינות',
  'אני חושב שזה בדיוק מה שאתה צריך עכשיו, וזה יכול לעזור לך מאוד להגיע למקום שאתה רוצה',
  
  // הודעות ארוכות על שיתוף רגשות
  'אני מרגיש שהתקופה האחרונה הייתה ממש מאתגרת, אבל אני שמח לראות שאתה מתמודד עם זה טוב',
  'רציתי לשתף אותך שאני ממש מעריך את העזרה והתמיכה שלך, זה ממש עוזר לי',
  'אני חייב להגיד שאני ממש התרשמתי ממה שעשית, זה לא דבר פשוט ואתה עשית את זה מצוין',
  'אני מרגיש שיש לנו חיבור טוב ושאנחנו מבינים אחד את השני, וזה משהו שאני ממש מעריך',
  'רציתי לשתף אותך שאני חושב שאתה אדם מיוחד ושאני שמח שיש לנו את הקשר הזה',
  
  // הודעות ארוכות על עצות
  'אם אתה שואל אותי, אני הייתי מציע לך לקחת את זה בצעדים קטנים ולא למהר יותר מדי, ככה זה בדרך כלל עובד טוב יותר',
  'לדעתי, הדרך הטובה ביותר להתקדם עם זה היא להתחיל בדברים הפשוטים ואז לעבור לדברים המורכבים יותר',
  'אם תרצה את העצה שלי, אני חושב שכדאי לך לבדוק את כל האפשרויות לפני שאתה מחליט, כדי שתהיה בטוח שזו הבחירה הנכונה',
  'מניסיון שלי, אני יכול להגיד לך שהדבר הכי חשוב זה להיות סבלני ולתת לדברים להתפתח בקצב הטבעי שלהם',
  'אני חושב שהגישה הנכונה כאן היא להיות גמיש ופתוח לשינויים, כי לפעמים הדברים לא הולכים בדיוק כמו שתכננו',
  
  // הודעות ארוכות על חוויות אישיות
  'אתמול היה לי יום ממש מעניין, עשיתי כמה דברים שלא תכננתי ובסוף זה יצא ממש טוב ומהנה',
  'השבוע היה לי די אינטנסיבי בעבודה, אבל אני מרגיש שהצלחתי להתמודד עם כל האתגרים והיו גם כמה הצלחות יפות',
  'אני חייב לספר לך, קרה לי משהו ממש מעניין היום. לא אכנס לפרטים כרגע אבל אספר לך בפעם הבאה שנדבר',
  'יש לי חדשות מעניינות לשתף איתך, אבל אני רוצה לספר לך את זה כשיהיה לנו יותר זמן לדבר על זה כמו שצריך',
  'קרה לי דבר משעשע היום ופשוט חייב לספר לך כשנדבר, אני בטוח שתמצא את זה מצחיק',
  
  // הודעות ארוכות על תודה והערכה
  'אני רוצה להודות לך על כל העזרה והתמיכה שנתת לי לאחרונה, זה ממש עזר ואני מעריך את זה מאוד',
  'תודה רבה על שהקשבת ועל שנתת לי עצות טובות, אני מרגיש שזה ממש עזר לי לראות את הדברים מזווית אחרת',
  'אני ממש מעריך את הזמן שהשקעת בלעזור לי עם זה, זה לא מובן מאליו ואני שמח שיש לי מישהו כמוך',
  'רק רציתי להגיד תודה על שאתה תמיד שם כשאני צריך, זה ממש משמעותי בשבילי ואני מעריך את זה',
  'תודה על כל הסבלנות והתמיכה, אני יודע שזה לא תמיד קל אבל אני ממש אסיר תודה',
  
  // הודעות ארוכות על שיתוף מחשבות
  'אני חושב שיש כאן הזדמנות ממש טובה לעשות משהו מיוחד, אבל צריך לתכנן את זה נכון ולוודא שעושים את זה בצורה הנכונה',
  'יש לי כמה מחשבות על איך אפשר לשפר את המצב הזה, אשמח לשמוע מה אתה חושב ואם יש לך הצעות נוספות',
  'אני מרגיש שיש פה פוטנציאל גדול, אבל צריך להבין בדיוק מה הצעדים הנכונים ואיך להתקדם בצורה חכמה',
  'חשבתי על זה הרבה והגעתי למסקנה שהדרך הטובה ביותר להתקדם היא לעשות את זה בצורה מדורגת ומתוכננת',
  'יש לי תחושה שאם נעשה את זה נכון, זה יכול להוביל לדברים ממש טובים ומעניינים',
  
  // הודעות ארוכות על עידוד
  'אני רואה שאתה עושה התקדמות מצוינת ואני רוצה שתדע שאני גאה בך ובמה שאתה משיג, המשך ככה',
  'תדע לך שאתה עושה עבודה נהדרת וזה נראה, אל תתייאש ותמשיך להאמין בעצמך כי אתה באמת טוב',
  'אני רוצה לעודד אותך להמשיך בדרך שאתה הולך בה, אתה בכיוון הנכון ואני בטוח שתצליח',
  'אל תוותר, אתה כבר עשית כל כך הרבה והשקעת כל כך הרבה מאמץ, זה בטוח ישתלם בסוף',
  'אני מאמין בך ובכישורים שלך, ואני יודע שאתה תצליח להשיג את כל מה שאתה רוצה',
  
  // הודעות ארוכות על חוויות משותפות
  'זוכר את הפעם ההיא שעשינו את זה ביחד? זה היה ממש כיף ואני חושב שכדאי שנעשה משהו כזה שוב בקרוב',
  'אני מתגעגע לתקופה שהיינו נפגשים יותר, מקווה שנוכל לחזור לזה בקרוב ולהשקיע זמן איכות ביחד',
  'איזה כיף היה כשעשינו את זה ביחד, אני חושב שצריך לחזור על זה כי זה היה ממש חוויה מיוחדת',
  'אני זוכר את השיחות שלנו על הנושא הזה, ועכשיו כשאני רואה את זה קורה אני מבין כמה צדקנו',
  
  // הודעות ארוכות על עדכונים
  'רציתי לעדכן אותך שהדברים מתקדמים טוב והכל זורם בדיוק כמו שתכננו, אשמח לשמוע מה אתה חושב',
  'יש לי כמה עדכונים לגבי הנושא שדיברנו עליו, אבל אני רוצה לספר לך את זה כשיהיה לנו זמן לדבר כמו שצריך',
  'מאז שדיברנו קרו כמה דברים מעניינים ואני חושב שכדאי שאעדכן אותך, תגיד לי מתי יש לך זמן',
  'יש התפתחות חדשה בנושא ואני רוצה לשתף אותך, אני חושב שזה משהו שיעניין אותך',
  
  // הודעות ארוכות על שאלות מעמיקות
  'אני תוהה מה דעתך על הכיוון שהדברים לוקחים לאחרונה? לי זה נראה מעניין אבל אשמח לשמוע את הפרספקטיבה שלך',
  'מה אתה חושב על המצב הכללי? אני מרגיש שיש הרבה דברים שקורים ורוצה לדעת איך אתה רואה את זה',
  'איך לדעתך כדאי להתמודד עם המצב הזה? אני מחפש עצות ורעיונות ואשמח לשמוע מה אתה חושב',
  'מה הגישה שלך בנושא הזה? אני מעריך את הדעה שלך ורוצה להבין איך אתה ניגש לדברים כאלה',
  
  // הודעות ארוכות על תכנון משותף
  'בוא נתחיל לתכנן את זה ביחד, אני חושב שאם נשב ונעבור על כל הפרטים נוכל לעשות משהו ממש מוצלח',
  'מה דעתך שנקבע פגישה ונעבור על כל האופציות? אני חושב שכדאי לשקול את כל הדרכים לפני שמחליטים',
  'אני מציע שנעשה את זה בצורה מסודרת: נתחיל עם תכנון, אחר כך ביצוע, ואז נעריך את התוצאות',
  'בוא נעבוד על זה ביחד צעד אחר צעד, ככה נוודא שאנחנו עושים את זה נכון ושלא פספסנו כלום',
  
  // הודעות ארוכות על התלבטויות
  'אני קצת מתלבט לגבי זה, מצד אחד זה נשמע טוב אבל מצד שני יש כמה דברים שמדאיגים אותי, מה דעתך?',
  'לא החלטתי עדיין מה לעשות עם זה, יש לי כמה אופציות ואני שוקל ביניהן, אשמח לשמוע את דעתך',
  'אני חושב הרבה על זה ועדיין לא הגעתי למסקנה ברורה, מה אתה אומר? איך היית ניגש לזה?',
  
  // הודעות ארוכות על שמחה
  'אני ממש שמח לשמוע שהכל עובד לך טוב ושאתה מרגיש טוב עם המצב, זה ממש נחמד לדעת',
  'כל הכבוד על ההישג! זה לא דבר קטן ואני ממש שמח בשבילך שהצלחת להגיע לזה',
  'איזה כיף לשמוע שזה עבד בסוף! אני זוכר כמה עבדת קשה על זה ומגיע לך כל הכבוד',
  
  // הודעות ארוכות על תובנות
  'הבנתי משהו מעניין לאחרונה בנושא הזה, ואני חושב שזה משהו ששווה לשתף אותך בו',
  'יש לי תובנה שאני רוצה לשתף איתך, אני חושב שזה משהו שיכול לעזור גם לך',
  'למדתי משהו חדש לאחרונה ואני חושב שזה ממש רלוונטי למה שאתה עובד עליו',
  
  // הודעות ארוכות על הזמנות
  'בא לך להיפגש בקרוב? אני חושב שיהיה כיף לנו לשבת ולדבר, מזמן לא עשינו את זה',
  'מה אתה אומר על לעשות משהו ביחד בשבוע הבא? אני פנוי וחושב שזה יהיה כיף',
  'יש לי רעיון למשהו שנוכל לעשות, מעניין אותך לשמוע? אני חושב שזה משהו שנהנה ממנו שנינו',
  
  // הודעות ארוכות על עדכוני מצב
  'אז המצב כרגע הוא שהכל מתקדם לאט אבל בטוח, אני מקווה שבשבועות הקרובים נראה עוד יותר התקדמות',
  'לגבי מה ששאלת, המצב עכשיו הוא די טוב ואני מרגיש שאנחנו בכיוון הנכון, צריך רק קצת יותר זמן',
  'רציתי לעדכן שהצלחתי לסיים את החלק הראשון והכל נראה טוב, עכשיו אני עובר לשלב הבא',
  
  // הודעות ארוכות על תקוות
  'אני מקווה שהשבוע הבא יהיה יותר רגוע ושנוכל סוף סוף לקדם את הדברים שתכננו',
  'אני מצפה שהדברים ישתפרו בקרוב ושנוכל להתחיל לראות תוצאות מהעבודה שהשקענו',
  'מקווה שבחודשים הקרובים נצליח להגיע למקום שרצינו ושכל המאמץ ישתלם',
  
  // הודעות ארוכות על סקרנות
  'אני ממש סקרן לדעת איך זה התפתח בסוף, תעדכן אותי כשיהיה לך זמן כי זה ממש מעניין אותי',
  'מעניין אותי מאוד מה קרה עם הנושא שדיברנו עליו, יש לך עדכונים? אשמח לשמוע',
  'אני תוהה מה יהיה עם זה בסופו של דבר, יש לך הרגשה לגבי זה?',
  
  // הודעות ארוכות על הצעות
  'יש לי הצעה למשהו שאני חושב שיכול לעבוד ממש טוב, מעניין אותך לשמוע? נדבר על זה בפעם הבאה',
  'חשבתי על משהו שיכול לעזור במצב הזה, אשמח לשתף אותך ולשמוע מה אתה חושב על זה',
  'יש לי רעיון שאני חושב שיכול להיות טוב, אבל אני רוצה לשמוע את דעתך לפני שממשיכים עם זה',
  
  // הודעות ארוכות על סיכומים
  'אז לסכם את מה שדיברנו, אני חושב שהכיוון ברור וצריך רק להתחיל לפעול לפי התוכנית',
  'בקיצור, המסקנה שלי היא שזה משהו ששווה לעשות והשאלה היא רק מתי ואיך בדיוק',
  'אם אני מבין נכון, אנחנו מסכימים שזו הדרך הנכונה ועכשיו צריך רק להתחיל לבצע',
  
  // הודעות ארוכות על הבנה
  'אני חושב שהבנתי את מה שאתה אומר ואני מסכים עם הגישה שלך, זה נשמע הגיוני ונכון',
  'עכשיו אחרי שהסברת לי את זה אני רואה את התמונה המלאה ואני מבין למה זה חשוב',
  'תודה על ההסבר, עכשיו הרבה יותר ברור לי ואני מרגיש שאני מבין את כל העניין',
  
  // הודעות ארוכות על תמיכה מתמשכת
  'רק רוצה שתדע שאני כאן לכל דבר שתצטרך, בין אם זה עזרה מעשית או פשוט מישהו להקשיב',
  'אם תרצה לדבר על זה או על כל דבר אחר, אני תמיד פה ואשמח לעזור בכל דרך שאני יכול',
  'זכור שאתה לא לבד בזה ושתמיד יש למי לפנות, אני כאן ואכפת לי',
  
  // הודעות ארוכות על הערכת מצב
  'לפי מה שאני רואה, המצב נראה די טוב בסך הכל ויש סיבה לאופטימיות, אבל צריך להמשיך לעקוב',
  'אני מעריך את המצב כחיובי בגדול, יש כמה אתגרים אבל אני חושב שאפשר להתמודד איתם',
  'נראה לי שאנחנו בדרך הנכונה, צריך רק להמשיך בקצב הזה ולא להתרשל',
  
  // הודעות ארוכות על שיתוף חוויות
  'היה לי משהו דומה לאחרונה ואני ממש מבין את מה שאתה עובר, זה לא קל אבל זה עובר',
  'גם אני עברתי משהו כזה ואני יכול להגיד לך שבסוף זה השתלם וזה היה שווה את המאמץ',
  'אני זוכר שכשעברתי דבר דומה, הדבר שעזר לי הכי הרבה היה פשוט לקחת את זה צעד אחר צעד',
  
  // הודעות ארוכות על תובנות חדשות
  'קראתי משהו מעניין לאחרונה על הנושא הזה ואני חושב שזה משהו שכדאי שנדבר עליו',
  'נתקלתי במידע חדש שאני חושב שרלוונטי למה שאנחנו עושים, אספר לך על זה בפעם הבאה',
  'יש חדשה מעניינת בתחום ואני חושב שכדאי שנעקוב אחרי זה ונראה איך זה מתפתח',
  
  // הודעות ארוכות על תכנון ארוך טווח
  'אני חושב שלטווח הארוך זה יכול להיות משהו ממש משמעותי, כדאי שנתחיל לחשוב על זה ברצינות',
  'לגבי העתיד, אני רואה את זה כהזדמנות גדולה ואני חושב שכדאי להשקיע בזה מאמץ',
  'אם נסתכל קדימה, אני חושב שיש פה פוטנציאל גדול ושכדאי לנו להיות חלק מזה',
];

interface WarmUpState {
  isRunning: boolean;
  accountTimeouts: Map<string, NodeJS.Timeout>; // accountId -> timeout
  messagesSentToday: Map<string, number>; // accountId -> count
  lastResetDate: string;
  maxMessagesPerDay: number;
  startHour: number;
  endHour: number;
}

export class WarmUpService {
  private db: Database;
  private whatsappManager: WhatsAppManager;
  private activeSessions: Map<string, WarmUpState> = new Map();

  constructor(db: Database, whatsappManager: WhatsAppManager) {
    this.db = db;
    this.whatsappManager = whatsappManager;
    
    // Resume any active warm-up sessions from before app closed
    this.resumeActiveSessions();
    
    // Reset daily counters at midnight
    this.startDailyReset();
  }

  private resumeActiveSessions(): void {
    try {
      const sessionStmt = this.db.prepare(`
        SELECT * FROM warmup_sessions 
        WHERE status = 'active'
      `);
      const activeSessions = sessionStmt.all() as any[];
      
      if (activeSessions.length > 0) {
        console.log(`🔥 Found ${activeSessions.length} active warm-up session(s), resuming...`);
        
        for (const session of activeSessions) {
          const startedAt = new Date(session.started_at);
          const now = new Date();
          const hoursSinceStart = (now.getTime() - startedAt.getTime()) / 1000 / 60 / 60;
          
          // If session has been running for more than 7 days, stop it (safety)
          if (hoursSinceStart > 168) { // 7 days
            console.log(`⚠️ Warm-up session has been running for ${Math.floor(hoursSinceStart)} hours, stopping for safety`);
            const stopStmt = this.db.prepare(`
              UPDATE warmup_sessions 
              SET status = 'stopped', stopped_at = ? 
              WHERE id = ?
            `);
            stopStmt.run(new Date().toISOString(), session.id);
          } else {
            // Get accounts for this session
            const accountsStmt = this.db.prepare(`
              SELECT account_id FROM warmup_accounts 
              WHERE session_id = ?
            `);
            const accountIds = (accountsStmt.all(session.id) as any[]).map(row => row.account_id);
            
            if (accountIds.length >= 2) {
              console.log(`🔥 Resuming warm-up session ${session.id} with ${accountIds.length} accounts`);
              console.log(`🔥 Session running for ${Math.floor(hoursSinceStart)} hours`);
              
              const now = new Date();
              const currentHour = now.getHours();
              const todayDate = now.toISOString().split('T')[0];
              const sessionStartDate = new Date(session.started_at).toISOString().split('T')[0];
              
              // Initialize session state
              // IMPORTANT: Always start with empty messagesSentToday on resume
              // This ensures fresh start each day
              this.activeSessions.set(session.id, {
                isRunning: true,
                accountTimeouts: new Map(),
                messagesSentToday: new Map(), // Always empty on resume
                lastResetDate: todayDate,
                maxMessagesPerDay: 40,
                startHour: 8,
                endHour: 22
              });
              
              // Log counter reset info
              if (todayDate === sessionStartDate) {
                console.log(`🔥 Resuming on same day as start - message counters reset to 0`);
              } else {
                console.log(`🔥 Resuming on new day - fresh start with counters at 0`);
              }
              
              // Check if we're within working hours
              if (currentHour >= 8 && currentHour < 22) {
                // בתוך שעות - התחל מיד
                console.log(`🔥 Within working hours (${currentHour}:00) - resuming immediately`);
                
                const delayIncrement = session.min_delay * 1000 / accountIds.length;
                
                accountIds.forEach((accountId, index) => {
                  const initialDelay = Math.random() * delayIncrement + (index * delayIncrement);
                  
                  console.log(`🔥 Resuming account ${index + 1}/${accountIds.length} (${accountId.substring(0, 8)}...) in ${Math.floor(initialDelay / 1000)}s`);
                  
                  setTimeout(() => {
                    console.log(`🔥 🚀 Resuming warm-up cycle for account ${accountId.substring(0, 8)}...`);
                    this.scheduleNextWarmUpForAccount(
                      session.id, 
                      accountIds, 
                      accountId, 
                      session.min_delay, 
                      session.max_delay
                    );
                  }, initialDelay);
                });
              } else if (currentHour < 8) {
                // לפני שעות עבודה - חכה עד 8:00
                const nextStart = new Date(now);
                nextStart.setHours(8, 0, 0, 0);
                const delay = nextStart.getTime() - now.getTime();
                
                console.log(`🔥 Before working hours (${currentHour}:00) - will resume at ${nextStart.toLocaleTimeString()}`);
                
                setTimeout(() => {
                  console.log(`🔥 Starting warm-up at working hours`);
                  const delayIncrement = session.min_delay * 1000 / accountIds.length;
                  
                  accountIds.forEach((accountId, index) => {
                    const initialDelay = Math.random() * delayIncrement + (index * delayIncrement);
                    
                    setTimeout(() => {
                      this.scheduleNextWarmUpForAccount(
                        session.id, 
                        accountIds, 
                        accountId, 
                        session.min_delay, 
                        session.max_delay
                      );
                    }, initialDelay);
                  });
                }, delay);
              } else {
                // אחרי שעות עבודה - חכה עד מחר ב-8:00
                const nextStart = new Date(now);
                nextStart.setDate(nextStart.getDate() + 1);
                nextStart.setHours(8, 0, 0, 0);
                const delay = nextStart.getTime() - now.getTime();
                
                console.log(`🔥 After working hours (${currentHour}:00) - will resume tomorrow at ${nextStart.toLocaleTimeString()}`);
                
                setTimeout(() => {
                  console.log(`🔥 Starting warm-up at working hours (next day)`);
                  const delayIncrement = session.min_delay * 1000 / accountIds.length;
                  
                  accountIds.forEach((accountId, index) => {
                    const initialDelay = Math.random() * delayIncrement + (index * delayIncrement);
                    
                    setTimeout(() => {
                      this.scheduleNextWarmUpForAccount(
                        session.id, 
                        accountIds, 
                        accountId, 
                        session.min_delay, 
                        session.max_delay
                      );
                    }, initialDelay);
                  });
                }, delay);
              }
              
              console.log(`🔥 ✅ Warm-up session ${session.id} configured for resume`);
            }
          }
        }
      } else {
        console.log('ℹ️ No active warm-up sessions to resume');
      }
    } catch (error) {
      console.error('Failed to resume warm-up sessions:', error);
    }
  }

  async startSession(accountIds: string[], minDelay: number, maxDelay: number): Promise<string> {
    // Check if there's already an active session
    const existingStmt = this.db.prepare(`SELECT id FROM warmup_sessions WHERE status = 'active' LIMIT 1`);
    const existingSession = existingStmt.get() as any;
    
    if (existingSession) {
      console.log(`ℹ️ Warm-up session ${existingSession.id} is already active`);
      return existingSession.id;
    }

    if (accountIds.length < 2) {
      throw new Error('At least 2 accounts are required for warm-up');
    }

    const sessionId = uuidv4();

    // Create session in database
    const sessionStmt = this.db.prepare(`
      INSERT INTO warmup_sessions (id, status, min_delay, max_delay)
      VALUES (?, 'active', ?, ?)
    `);
    sessionStmt.run(sessionId, minDelay, maxDelay);

    // Add accounts to session
    const accountStmt = this.db.prepare(`
      INSERT INTO warmup_accounts (session_id, account_id)
      VALUES (?, ?)
    `);

    const insertAccounts = this.db.transaction((ids: string[]) => {
      for (const accountId of ids) {
        accountStmt.run(sessionId, accountId);
      }
    });

    insertAccounts(accountIds);

    // Initialize session state with smart limits
    this.activeSessions.set(sessionId, {
      isRunning: true,
      accountTimeouts: new Map(),
      messagesSentToday: new Map(),
      lastResetDate: new Date().toISOString().split('T')[0],
      maxMessagesPerDay: 40, // Smart limit: 40 messages per account per day
      startHour: 8,  // Start at 8 AM
      endHour: 22    // End at 10 PM
    });

    // Start warm-up for ALL accounts in parallel (with staggered initial delays)
    console.log(`🔥 Starting warm-up session ${sessionId} with ${accountIds.length} accounts in parallel`);
    console.log(`🔥 Settings: minDelay=${minDelay}s (${minDelay/60}min), maxDelay=${maxDelay}s (${maxDelay/60}min)`);
    console.log(`🔥 Smart limits: max ${state.maxMessagesPerDay} msgs/account/day, hours ${state.startHour}:00-${state.endHour}:00`);
    
    // Stagger the initial delays to avoid all accounts sending at once
    // Spread them across the first interval (minDelay)
    const delayIncrement = minDelay * 1000 / accountIds.length; // Spread across min delay period
    
    accountIds.forEach((accountId, index) => {
      // Each account starts at a different time within the first interval
      const initialDelay = Math.random() * delayIncrement + (index * delayIncrement);
      
      console.log(`🔥 Account ${index + 1}/${accountIds.length} (${accountId.substring(0, 8)}...) will start in ${Math.floor(initialDelay / 1000)} seconds`);
      
      setTimeout(() => {
        console.log(`🔥 🚀 Starting warm-up cycle for account ${accountId.substring(0, 8)}...`);
        this.scheduleNextWarmUpForAccount(sessionId, accountIds, accountId, minDelay, maxDelay);
      }, initialDelay);
    });

    console.log(`🔥 ✅ Warm-up session ${sessionId} initialized successfully`);
    return sessionId;
  }

  async stopSession(sessionId: string): Promise<void> {
    const state = this.activeSessions.get(sessionId);
    if (state) {
      state.isRunning = false;
      // Clear all account timeouts
      for (const timeout of state.accountTimeouts.values()) {
        clearTimeout(timeout);
      }
      state.accountTimeouts.clear();
      this.activeSessions.delete(sessionId);
    }

    const stmt = this.db.prepare(`
      UPDATE warmup_sessions 
      SET status = 'stopped', stopped_at = ?
      WHERE id = ?
    `);
    stmt.run(new Date().toISOString(), sessionId);
  }

  async getActiveSession(): Promise<any> {
    // Get the first active session
    const activeSessionId = Array.from(this.activeSessions.keys())[0];
    
    if (!activeSessionId) {
      return null;
    }

    const sessionStmt = this.db.prepare(`
      SELECT * FROM warmup_sessions WHERE id = ?
    `);
    const session = sessionStmt.get(activeSessionId) as any;

    if (!session) {
      return null;
    }

    const accountsStmt = this.db.prepare(`
      SELECT account_id FROM warmup_accounts WHERE session_id = ?
    `);
    const accounts = (accountsStmt.all(activeSessionId) as any[]).map(row => row.account_id);

    const state = this.activeSessions.get(activeSessionId);

    return {
      ...session,
      accounts,
      messages_sent_today: state ? Array.from(state.messagesSentToday.values()).reduce((a, b) => a + b, 0) : 0
    };
  }

  private async scheduleNextWarmUpForAccount(
    sessionId: string,
    allAccountIds: string[],
    accountId: string,
    minDelay: number,
    maxDelay: number
  ): Promise<void> {
    const state = this.activeSessions.get(sessionId);
    if (!state || !state.isRunning) {
      console.log(`🔥 ❌ Session ${sessionId} is not running or not found - stopping account ${accountId.substring(0, 8)}...`);
      return;
    }

    const timestamp = new Date().toLocaleTimeString();
    console.log(`🔥 ⏰ [${timestamp}] Warm-up cycle for account ${accountId.substring(0, 8)}... (sent today: ${state.messagesSentToday.get(accountId) || 0}/${state.maxMessagesPerDay})`);

    // Check working hours
    const now = new Date();
    const currentHour = now.getHours();

    if (currentHour < state.startHour || currentHour >= state.endHour) {
      // Schedule next check at start_hour
      const tomorrow = new Date(now);
      tomorrow.setHours(state.startHour, 0, 0, 0);
      
      if (currentHour >= state.endHour) {
        tomorrow.setDate(tomorrow.getDate() + 1);
      }

      const delay = tomorrow.getTime() - now.getTime();
      console.log(`🔥 Outside working hours - scheduling next attempt at ${tomorrow.toLocaleTimeString()}`);
      const timeout = setTimeout(() => {
        this.scheduleNextWarmUpForAccount(sessionId, allAccountIds, accountId, minDelay, maxDelay);
      }, delay);
      state.accountTimeouts.set(accountId, timeout);
      return;
    }

    // Reset daily counters if needed
    this.resetDailyCountersIfNeeded(sessionId);

    // Check if account reached daily limit
    const sentToday = state.messagesSentToday.get(accountId) || 0;
    if (sentToday >= state.maxMessagesPerDay) {
      console.log(`🔥 Account ${accountId} reached daily warm-up limit (${sentToday}/${state.maxMessagesPerDay})`);
      // Schedule next attempt tomorrow (after midnight reset)
      const tomorrow = new Date(now);
      tomorrow.setDate(tomorrow.getDate() + 1);
      tomorrow.setHours(state.startHour, 0, 0, 0);
      
      const delay = tomorrow.getTime() - now.getTime();
      console.log(`🔥 Will resume warm-up tomorrow at ${tomorrow.toLocaleTimeString()}`);
      const timeout = setTimeout(() => {
        this.scheduleNextWarmUpForAccount(sessionId, allAccountIds, accountId, minDelay, maxDelay);
      }, delay);
      state.accountTimeouts.set(accountId, timeout);
      return;
    }

    // Try to send message
    let sendSuccessful = false;
    try {
      await this.sendWarmUpMessageFromAccount(sessionId, allAccountIds, accountId);
      sendSuccessful = true;
    } catch (error) {
      console.error(`❌ Error sending warm-up message from account ${accountId}:`, error);
      console.log('🔥 Will retry on next cycle...');
      sendSuccessful = false;
    }

    // Always schedule next message (whether success or failure)
    // If failed, use shorter delay for retry
    let delay: number;
    if (sendSuccessful) {
      // Normal delay (minDelay to maxDelay)
      delay = getRandomDelay(minDelay, maxDelay) * 1000;
      console.log(`🔥 ✅ Next warm-up message from ${accountId} in ${Math.floor(delay / 1000 / 60)} minutes (${Math.floor(delay / 1000)} seconds)`);
    } else {
      // Shorter delay for retry (2-5 minutes)
      delay = getRandomDelay(120, 300) * 1000; // 2-5 minutes
      console.log(`🔥 ⚠️ Retry warm-up from ${accountId} in ${Math.floor(delay / 1000 / 60)} minutes due to previous failure`);
    }
    
    const timeout = setTimeout(() => {
      this.scheduleNextWarmUpForAccount(sessionId, allAccountIds, accountId, minDelay, maxDelay);
    }, delay);
    state.accountTimeouts.set(accountId, timeout);
    
    console.log(`🔥 Timeout scheduled for account ${accountId} (ID: ${timeout})`);
  }

  private async sendWarmUpMessageFromAccount(
    sessionId: string,
    allAccountIds: string[],
    senderId: string
  ): Promise<void> {
    const state = this.activeSessions.get(sessionId);
    if (!state) {
      console.log(`🔥 Session ${sessionId} not found in active sessions`);
      return;
    }

    // Check if sender is connected
    if (!this.whatsappManager.isConnected(senderId)) {
      console.log(`🔥 Account ${senderId} is not connected, will retry on next cycle...`);
      return; // Will be retried by scheduleNextWarmUpForAccount
    }

    // Get client to check state
    const client = this.whatsappManager.getConnection(senderId);
    if (!client) {
      console.log(`🔥 Account ${senderId} has no active client, will retry on next cycle...`);
      return; // Will be retried by scheduleNextWarmUpForAccount
    }

    // Verify client is truly ready
    try {
      const clientState = await client.getState();
      if (clientState !== 'CONNECTED') {
        console.log(`🔥 Account ${senderId} not ready yet (state: ${clientState}), will retry on next cycle...`);
        return; // Will be retried by scheduleNextWarmUpForAccount
      }
    } catch (e) {
      console.log(`🔥 Account ${senderId} state check failed, will retry on next cycle...`);
      return; // Will be retried by scheduleNextWarmUpForAccount
    }

    // Filter other connected accounts (exclude sender)
    const otherAccounts = allAccountIds.filter(id => 
      id !== senderId && this.whatsappManager.isConnected(id)
    );

    if (otherAccounts.length === 0) {
      console.log(`🔥 No other connected accounts available for ${senderId}, will retry on next cycle...`);
      return; // Will be retried by scheduleNextWarmUpForAccount
    }

    // Select random receiver from other accounts
    const receiverId = otherAccounts[Math.floor(Math.random() * otherAccounts.length)];

    // Get receiver's phone number
    const stmt = this.db.prepare('SELECT phone_number FROM accounts WHERE id = ?');
    const receiver = stmt.get(receiverId) as any;

    if (!receiver || !receiver.phone_number) {
      console.error('Receiver account not found or has no phone number');
      return;
    }

    // Clean and format phone number properly
    let receiverPhone = receiver.phone_number;
    
    console.log(`🔥 Raw phone from DB: "${receiverPhone}"`);
    
    // Remove all non-digits and any WhatsApp suffix if exists
    receiverPhone = receiverPhone.replace(/\D/g, ''); // Remove +, -, spaces, @c.us, @lid, etc.
    
    console.log(`🔥 Cleaned phone: "${receiverPhone}"`);
    
    // Ensure it has country code
    if (!receiverPhone.startsWith('972') && !receiverPhone.startsWith('1') && !receiverPhone.startsWith('44')) {
      console.error(`❌ Invalid phone number format: ${receiver.phone_number} → ${receiverPhone}`);
      return;
    }

    console.log(`🔥 Warm-up: Sender ${senderId.substring(0, 8)}... → Receiver ${receiverId.substring(0, 8)}... (${receiverPhone})`);

    // Select random message
    const message = WARMUP_MESSAGES[Math.floor(Math.random() * WARMUP_MESSAGES.length)];
    console.log(`🔥 Message to send: "${message.substring(0, 50)}${message.length > 50 ? '...' : ''}"`);

    try {
      // Add small random delay (0-10 seconds) to make it more natural
      const naturalDelay = Math.floor(Math.random() * 10000);
      if (naturalDelay > 0) {
        console.log(`🔥 Adding natural delay of ${naturalDelay / 1000}s before sending...`);
        await new Promise(resolve => setTimeout(resolve, naturalDelay));
      }
      
      // Send message - will be formatted to @c.us in sendMessage (NOT @lid!)
      // Mark as warmup so it won't show in Inbox
      await this.whatsappManager.sendMessage(senderId, receiverPhone, message, true);
      
      console.log(`✅ Warm-up message sent successfully!`);

      // Increment counter only on success
      const currentCount = state.messagesSentToday.get(senderId) || 0;
      state.messagesSentToday.set(senderId, currentCount + 1);

      const timestamp = new Date().toLocaleTimeString();
      console.log(`🔥 ✅ Warm-up [${timestamp}]: ${senderId.substring(0, 8)}... sent message #${currentCount + 1}/${state.maxMessagesPerDay}`);
    } catch (error) {
      console.error(`❌ Failed to send warm-up message:`, error);
      console.log(`🔥 ⚠️ Will retry on next cycle...`);
      // Don't throw - let scheduleNextWarmUpForAccount handle retry
    }
  }

  private resetDailyCountersIfNeeded(sessionId: string): void {
    const state = this.activeSessions.get(sessionId);
    if (!state) return;

    const today = new Date().toISOString().split('T')[0];
    if (state.lastResetDate !== today) {
      state.messagesSentToday.clear();
      state.lastResetDate = today;
      console.log('🔄 Daily warm-up counters reset');
    }
  }

  private startDailyReset(): void {
    // Reset at midnight every day
    const now = new Date();
    const tomorrow = new Date(now);
    tomorrow.setDate(tomorrow.getDate() + 1);
    tomorrow.setHours(0, 0, 0, 0);

    const msUntilMidnight = tomorrow.getTime() - now.getTime();

    setTimeout(() => {
      // Reset all daily counters
      for (const [sessionId, state] of this.activeSessions) {
        state.messagesSentToday.clear();
        state.lastResetDate = new Date().toISOString().split('T')[0];
      }

      console.log('🔄 All warm-up daily counters reset at midnight');

      // Schedule next reset
      this.startDailyReset();
    }, msUntilMidnight);
  }
}
